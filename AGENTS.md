# AGENTS.md

## Purpose
This file is the operating guide for contributors and coding agents working in `relewise-sdk-java`.

The repository is a Java SDK with generated client/models and Maven-based build/release workflows. Follow this guide to keep changes scoped, verifiable, and CI-aligned.

## Repository Map
- `src/pom.xml`: Maven project manifest (packaging, test, release profile).
- `src/src/main/java/com/relewise/client`: Java SDK source.
- `src/src/test/java/com/relewise/client`: JUnit tests.
- `Generator`: .NET generator project for Java SDK code.
- `.github/workflows`: CI, publish, and Trello workflows.
- `generate.ps1` / `generate.sh`: generation entry points.
- `DEVELOPMENT.md`: local development notes.
- `PUBLISH.md`: release workflow and troubleshooting notes.
- `openapitools.json`, `swagger.json`: generation/reference assets.

## Core Working Conventions
- Run generation scripts from repository root.
- Run Maven commands against `src/pom.xml`.
- Keep changes minimal and related to the task.
- Do not commit secrets (`DATASET_ID`, `API_KEY`, Sonatype/GPG credentials).
- Treat generator output as generated code:
  - `src/src/main/java/com/relewise/client/model` is generator-owned.
  - Client layers in `src/src/main/java/com/relewise/client` are also generated by current pipeline.
- Prefer generator changes + regeneration over manual edits in generated files.

## Generation Workflow
Prerequisite: .NET 10 SDK or newer.

Use one of:

```powershell
./generate.ps1
```

```bash
./generate.sh
```

The generator writes SDK code into `src/src/main/java/com/relewise/client`.

## Runbook
Generate SDK code:

```powershell
./generate.ps1
```

```bash
./generate.sh
```

Build package:

```powershell
mvn --batch-mode -DskipTests package --file src/pom.xml
```

Generate `project.properties` for runtime version metadata:

```powershell
mvn resources:resources --file src/pom.xml
```

Run tests:

```powershell
mvn --batch-mode test --file src/pom.xml
```

## Testing and Credentials
- Tests use `DATASET_ID` and `API_KEY` from environment (`TestBase`).
- CI injects credentials from secrets.
- If credentials are unavailable locally, explicitly report integration-style test coverage as not run.

## Validation Policy (CI-Aligned, Pragmatic)
- Required for normal changes:
  - Regenerate when touching generator-owned surfaces.
  - Run package + test commands against `src/pom.xml`.
- Required for behavior/API changes:
  - Run tests covering affected request/response flows.
- Required for release/publish changes:
  - Validate relevant release-profile commands as appropriate.
  - Follow `PUBLISH.md` as source of truth for release operations.

## PR Expectations
Each PR should include:
- Scope: what changed and why.
- Risk notes: behavior or release surface impacted.
- Validation: exact commands run and results.
- Generation note: whether generation scripts were run.

## Known Pitfalls
- Maven project lives under `src`; root-level `mvn` without `--file src/pom.xml` is wrong.
- Skipping `mvn resources:resources --file src/pom.xml` can leave client version metadata stale.
- Manual edits to generated files create drift on next generation run.
